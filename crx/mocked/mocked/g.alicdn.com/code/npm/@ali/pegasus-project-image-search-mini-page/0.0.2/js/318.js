(self.webpackChunk_ali_pegasus_project_image_search_mini_page=self.webpackChunk_ali_pegasus_project_image_search_mini_page||[]).push([[318],{1467:function(n){n.exports={imgFilterItem:"imgFilterItem--oHZcCav3",activeArr:"activeArr--RZnUM1y3",imgFilterItemActive:"imgFilterItemActive--XEDM6PFX",imgFilterItemImgWrapper:"imgFilterItemImgWrapper--KOzGLrUv",imgFilterItemImg:"imgFilterItemImg--Shk387SR",origiTagWrapper:"origiTagWrapper--RVaYZn_1"}},9318:function(n,e,t){t.r(e),t.d(e,{default:function(){return d}});var i=t(4885),r=t(4092),o=t(1282),a=t(6966),l=t(1467),c=t.n(l),u=t(9282),s=!1;function d(n){var e=n.imgUrl,t=n.index,l=n.currentIndex,d=n.setCurrentIndex,m=n.style,g=n.isOrigin,h=n.freashData,v=function(){var n=(0,i._)((function(){var n,i,o,l;return(0,r.Jh)(this,(function(r){switch(r.label){case 0:if((0,u.S)(),s||g)return[2];s=!0,n=setTimeout((function(){s=!1,n&&clearTimeout(n)}),300),d(t),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,(0,a.R)(e,"pluginSubImg")];case 2:return l=r.sent(),h((null===(o=l)||void 0===o||null===(i=o.res)||void 0===i?void 0:i.data)||null),[3,4];case 3:return r.sent(),[3,4];case 4:return[2]}}))}));return function(){return n.apply(this,arguments)}}();return(0,o.BX)("div",{className:"".concat(c().imgFilterItem," ").concat(l===t?c().imgFilterItemActive:""),onClick:v,style:m||{},children:[(0,o.tZ)("div",{className:c().imgFilterItemImgWrapper,children:(0,o.tZ)("img",{src:e,className:c().imgFilterItemImg})}),(0,o.tZ)("img",{src:"https://img.alicdn.com/imgextra/i2/O1CN01nLOdHC1UmWt8BD95Y_!!6000000002560-2-tps-21-9.png",className:c().activeArr})]})}},6966:function(n,e,t){t.d(e,{R:function(){return x},q:function(){return C}});var i=t(4885),r=t(5486),o=t(2661),a=t(4092),l=t(4066),c=t(5910),u=t(2854),s=t(572),d=t.n(s),m=t(6971),g=t.n(m),h=t(8154),v=t.n(h),f=t(1808),p=t.n(f),w=t(7564),I=t.n(w),b=t(4728),_=t.n(b),R=null;function y(n,e){if(R&&R.logCustom)try{R.logCustom((0,r._)({p1:n||""},e||{}))}catch(t){console.error("arms-error",t)}}try{(R=d()({pid:"tb_pc_search",env:window.location.hostname.indexOf("wapa.")>=0||window.location.hostname.indexOf("pre-")>=0||window.location.hostname.indexOf("localhost")>=0?"pre":"prod",plugins:[[I()],[g(),{sampling:.1}],[v()],[p(),{ignoreQueries:!0,ignore(n,e){var t,i,r,o;return!(!n||!((null===(i=n)||void 0===i||null===(t=i.indexOf)||void 0===t?void 0:t.call(i,"//kgb-ifs.tanx.com/kgb"))>=0||(null===(o=n)||void 0===o||null===(r=o.indexOf)||void 0===r?void 0:r.call(o,"//click.simba.taobao.com/cc_im"))>=0))}}],[_(),{detectedDom:["#ice-container","#pageContent"],threshold:5,isPolling:!1}]]})).install()}catch(T){console.error("arms-error",T)}function S(n,e){return O.apply(this,arguments)}function O(){return(O=(0,i._)((function(n,e){var t,i,r,o,l;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:if(!(null===(i=window)||void 0===i||null===(t=i.securitySDK)||void 0===t?void 0:t.sign))return[2,{}];a.label=1;case 1:return a.trys.push([1,3,,4]),r=performance.now(),[4,window.securitySDK.sign({pageFrom:n,imgFrom:e})];case 2:return o=a.sent(),l=performance.now()-r,y("search_suggest_photoSafeCheck",{c1:"".concat(l),c2:"".concat(n||"null"),c3:"".concat(e||"null")}),[2,o];case 3:return a.sent(),[3,4];case 4:return[2,{}]}}))}))).apply(this,arguments)}var F={changeStatus:function(n){}};function C(n){n&&(F=(0,r._)({},F,n))}function E(n){return n.replace(/^data:image\/\w+;base64,/,"")}var U=function(n,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return F.changeStatus(c.$m.LOADING),new Promise((function(i,o){var a;(null===(a=c.ZP)||void 0===a?void 0:a.request)||(F.changeStatus(c.$m.ERROR),o("Mtop is not defined")),c.ZP.request((0,r._)({api:n,v:"2.0",type:"POST",data:e},t||{})).then((function(n){var e,t,r,a,l,u,s=(null===(t=null===(a=n)||void 0===a||null===(r=a.ret)||void 0===r?void 0:r[0])||void 0===t||null===(e=t.split)||void 0===e?void 0:e.call(t,"::")[1])||"";200===(null===(u=n)||void 0===u||null===(l=u.data)||void 0===l?void 0:l.code)?(F.changeStatus(c.$m.READAY),i({res:n,retMessage:s})):(F.changeStatus(c.$m.ERROR),o({res:n,retMessage:s}))})).catch((function(n){var e,t,i;F.changeStatus(c.$m.ERROR);var r=(null===(i=n)||void 0===i||null===(t=i.ret)||void 0===t||null===(e=t[0])||void 0===e?void 0:e.split("::")[1])||"";o({res:n,retMessage:r})}))}))};function x(n,e){return A.apply(this,arguments)}function A(){return(A=(0,i._)((function(n,e){var t,i,s,d,m,g,h,v,f,p,w,I,b,_,R,O,C,x,A,T,D,k,N,P,W;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:if(a.trys.push([0,7,,8]),f={},!(v=n||""))return[3,4];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,(0,l.hv)(v)];case 2:return f=a.sent(),v=(null===(w=f)||void 0===w||null===(p=w.newImg)||void 0===p?void 0:p.dataUrl)||v||"",[3,4];case 3:return a.sent(),[3,4];case 4:return[4,S(null===(t=u.B5)||void 0===t?void 0:t.imgSearchOrigin,e)];case 5:return I=a.sent(),b=(0,r._)({page:1,pageSize:60,strimg:E(v),ttid:"1@tbwang_mac_1.0.0#pc",imgFrom:e,pageFrom:null===(i=u.B5)||void 0===i?void 0:i.imgSearchOrigin},I||{}),[4,U("mtop.alibaba.fc.meta.front.photosearch.recommend.plugin",b,{ignTbpass:!0,v:"1.0"})];case 6:return _=a.sent(),R=(null===(m=_)||void 0===m||null===(d=m.res)||void 0===d||null===(s=d.data)||void 0===s?void 0:s.value)||{},_&&((null===(g=R)||void 0===g?void 0:g.itemsArray)||(null===(h=R)||void 0===h?void 0:h.pltInfo))||F.changeStatus(c.$m.ERROR),[2,(0,o._)((0,r._)({},_),{imgData:f})];case 7:return O=a.sent(),console.error(O),F.changeStatus(c.$m.ERROR),y("imageSearchPlugin_mainApi_error",{c1:"".concat(JSON.stringify(O||{}))}),((null===(D=O)||void 0===D||null===(T=D.res)||void 0===T||null===(A=T.ret)||void 0===A||null===(x=A[0])||void 0===x||null===(C=x.includes)||void 0===C?void 0:C.call(x,"\u63a5\u53e3\u5f02\u5e38\u9000\u51fa"))||"4001"==="".concat(null===(P=O)||void 0===P||null===(N=P.res)||void 0===N||null===(k=N.data)||void 0===k?void 0:k.code))&&(W=(null==="https://login.taobao.com/member/login.jhtml"?void 0:"https://login.taobao.com/member/login.jhtml".includes("?"))?"&":"?",window.location.href="".concat("https://login.taobao.com/member/login.jhtml").concat(W,"redirectURL=").concat(encodeURIComponent(window.location.href))),[2,null];case 8:return[2]}}))}))).apply(this,arguments)}},5910:function(n,e,t){t.d(e,{$m:function(){return a}});var i,r,o,a,l,c=t(4121),u=t.n(c),s=t(5978),d=t(2854),m=!((null===(i=window.location.hostname)||void 0===i?void 0:i.includes("pre-"))||(null===(r=window.location.hostname)||void 0===r?void 0:r.includes("localhost"))),g=(0,s.oA)(null===(o=d.B5)||void 0===o?void 0:o.isMock);!function(n){n.FIRSTIN="firstin",n.READAY="ready",n.ERROR="error",n.LOADING="loading"}(a||(a={})),!m&&g?l={request:function(n){var e=n.api,t=n.data;return new Promise((function(n,i){fetch("https://kaola-datahub.alibaba-inc.com/data/tbpc-search/".concat(e),{method:"POST",body:JSON.stringify(t)}).then((function(n){return n.json()})).then((function(e){var t;e.api&&"SUCCESS::\u8c03\u7528\u6210\u529f"===(null===(t=e.ret)||void 0===t?void 0:t[0])?n(e):i(e)})).catch((function(n){var e;console.error("request error",(null===(e=n)||void 0===e?void 0:e.message)||"\u9519\u8bef\u5bf9\u8c61\u4e3a\u7a7a"),i(n)}))}))}}:(u().config.subDomain=m?"m":"wapa",u().config.H5Request=!0,l=u()),e.ZP=l},4066:function(n,e,t){t.d(e,{N8:function(){return c},hv:function(){return l}});var i=t(5177),r=934,o=102400;function a(n){var e,t;return n&&n.length&&(null===(e=n)||void 0===e?void 0:e.length)?2*(null===(t=n)||void 0===t?void 0:t.length):0}function l(n){return new Promise((function(e,t){if(!n)return t({success:!1,message:"input not find"});var i=new Image;i.onload=function(){var n=document.createElement("canvas"),l=n.getContext("2d");if(n&&l){var c=1,u={dataUrl:"",size:0,w:0,h:0},s=null;do{if(i.naturalWidth>r||i.naturalHeight>r?i.naturalWidth>i.naturalHeight?(n.width=r,n.height=i.naturalHeight*r/i.naturalWidth):(n.height=r,n.width=i.naturalWidth*r/i.naturalHeight):(n.width=i.naturalWidth,n.height=i.naturalHeight),l.drawImage(i,0,0,n.width,n.height),u.dataUrl=n.toDataURL("image/jpeg",c),u.size=a(u.dataUrl),u.w=n.width,u.h=n.height,s||(s=u),a(u.dataUrl)<=o)break;c-=.1}while(c>.1);a(u.dataUrl)>o&&t({newImg:u,oldImg:s,success:!1,message:"image too large"}),i.onerror=function(){t({success:!1,message:"image load failed"})},e({newImg:u,oldImg:s,success:a(u.dataUrl)<=o})}else t({success:!1,message:"canvas not find"})},i.crossOrigin="anonymous",i.src=n}))}function c(n,e,t,r){return new Promise((function(e,t){var o=function(n){return n.split(";").map((function(n){var e=(0,i._)(n.split(",").map(Number),4),t=e[0],r=e[1],o=e[2],a=e[3];return{x:t,y:o,width:Math.abs(r-t),height:Math.abs(a-o)}}))}(r),a=new Image;a.onload=function(){for(var n=[],i=0;i<o.length;i++){var r=o[i],l=r.x,c=r.y,u=r.width,s=r.height,d=document.createElement("canvas");d.width=u,d.height=s;var m=d.getContext("2d");if(!m)return void t("Image load failed.");m.drawImage(a,l,c,u,s,0,0,u,s),n.push(d.toDataURL("image/png"))}e(n)},a.onerror=function(){t("Image load failed.")},a.crossOrigin="anonymous",a.src=n}))}},9282:function(n,e,t){t.d(e,{S:function(){return i}});var i=function(){try{if(window.scrollTo)window.scrollTo(0,0);else{if(void 0===document.body.scrollTop||void 0===document.documentElement.scrollTop)throw new Error("scrollTo error");document.body.scrollTop=0,document.documentElement.scrollTop=0}}catch(n){throw new Error(n)}}}}]);